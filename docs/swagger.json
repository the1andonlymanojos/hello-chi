{
    "swagger": "2.0",
    "info": {
        "contact": {}
    },
    "paths": {
        "/download/{identifier}": {
            "get": {
                "description": "Downloads a file with a valid identifier. The eTag is used to retrieve the file Metadata from the Redis database. As long as the ownerId matches that in the cookie, the file is served.",
                "tags": [
                    "Files"
                ],
                "summary": "Download file",
                "parameters": [
                    {
                        "type": "string",
                        "description": "File identifier (etag)",
                        "name": "identifier",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "File downloaded successfully",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "206": {
                        "description": "Binary data",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "400": {
                        "description": "Bad request or invalid identifier",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "500": {
                        "description": "Bad request or invalid identifier",
                        "schema": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "/upload/initiate": {
            "post": {
                "description": "Initiates the upload process by creating metadata and returning an identifier",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Files"
                ],
                "summary": "Initiate file upload",
                "parameters": [
                    {
                        "description": "File upload request",
                        "name": "uploadReq",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/handlers.UploadRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "eTag identifier for the file upload",
                        "schema": {
                            "$ref": "#/definitions/handlers.UploadResponse"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "/upload/internal": {
            "post": {
                "description": "Used by file conversion services to upload files internally",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Internal API"
                ],
                "summary": "Upload file internally",
                "parameters": [
                    {
                        "description": "File upload request",
                        "name": "uploadReq",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/handlers.UploadFileInternalRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "File uploaded successfully",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "/upload/{identifier}": {
            "put": {
                "description": "Uploads a file chunk with a valid identifier and content range",
                "tags": [
                    "Files"
                ],
                "summary": "Upload file chunk",
                "parameters": [
                    {
                        "type": "string",
                        "description": "File identifier (etag)",
                        "name": "identifier",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Content-Range of the chunk (e.g., bytes 0-100/500)",
                        "name": "Content-Range",
                        "in": "header",
                        "required": true
                    }
                ],
                "responses": {
                    "206": {
                        "description": "Chunk uploaded successfully",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "400": {
                        "description": "Bad request or invalid chunk range",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "999": {
                        "description": "FileMetaData",
                        "schema": {
                            "$ref": "#/definitions/utils.FileMetaData"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "handlers.UploadFileInternalRequest": {
            "type": "object",
            "properties": {
                "hash": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "owner": {
                    "type": "string"
                },
                "path": {
                    "type": "string"
                },
                "size": {
                    "type": "integer"
                },
                "uuid": {
                    "type": "string"
                }
            }
        },
        "handlers.UploadRequest": {
            "type": "object",
            "properties": {
                "hash": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "size": {
                    "type": "integer"
                }
            }
        },
        "handlers.UploadResponse": {
            "type": "object",
            "properties": {
                "eTag": {
                    "type": "string"
                }
            }
        },
        "utils.FileMetaData": {
            "description": "FileMetaData represents metadata for a file upload.",
            "type": "object",
            "properties": {
                "hash": {
                    "type": "string"
                },
                "last_byte_received": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "owner": {
                    "type": "string"
                },
                "path": {
                    "type": "string"
                },
                "size": {
                    "type": "integer"
                },
                "ttl": {
                    "type": "integer"
                },
                "upload_date": {
                    "type": "string"
                }
            }
        }
    }
}